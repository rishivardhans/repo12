this is 200 lines of the java file
